apiVersion: v1
kind: Service
metadata:
  name: $(APP_NAME)
  namespace: $(NAMESPACE)
  labels:
    app: $(APP_NAME)
    compliance.region: $(REGION)
    # Compliance labels for automatic routing via enterprise-sim.sh routes reconcile
    compliance.routing/enabled: "true"
    compliance.routing/host: "$(ROUTE_HOST)"  # Creates {region}-$(ROUTE_HOST).{domain}
    compliance.routing/port: "443"
  annotations:
    # Service mesh annotations
    service.beta.kubernetes.io/aws-load-balancer-type: nlb  # If using AWS
spec:
  type: ClusterIP
  selector:
    app: $(APP_NAME)
  ports:
  - name: https
    port: 443
    targetPort: 443
    protocol: TCP
